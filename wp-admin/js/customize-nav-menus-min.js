!function(v,h,g){"use strict";function t(e){return"nav_menu_item["+e+"]"}function d(e){return e=e||"",e=g("<div>").text(e).html(),(e=g.trim(e))||v.Menus.data.l10n.unnamed}wpNavMenu.originalInit=wpNavMenu.init,wpNavMenu.options.menuItemDepthPerLevel=20,wpNavMenu.options.sortableItems="> .customize-control-nav_menu_item",wpNavMenu.options.targetTolerance=10,wpNavMenu.init=function(){this.jQueryExtensions()},v.Menus=v.Menus||{},v.Menus.data={itemTypes:[],l10n:{},settingTransport:"refresh",phpIntMax:0,defaultSettingValues:{nav_menu:{},nav_menu_item:{}},locationSlugMappedToName:{}},"undefined"!=typeof _wpCustomizeNavMenusSettings&&g.extend(v.Menus.data,_wpCustomizeNavMenusSettings),v.Menus.generatePlaceholderAutoIncrementId=function(){return-Math.ceil(v.Menus.data.phpIntMax*Math.random())},v.Menus.AvailableItemModel=Backbone.Model.extend(g.extend({id:null},v.Menus.data.defaultSettingValues.nav_menu_item)),v.Menus.AvailableItemCollection=Backbone.Collection.extend({model:v.Menus.AvailableItemModel,sort_key:"order",comparator:function(e){return-e.get(this.sort_key)},sortByField:function(e){this.sort_key=e,this.sort()}}),v.Menus.availableMenuItems=new v.Menus.AvailableItemCollection(v.Menus.data.availableMenuItems),v.Menus.insertAutoDraftPost=function e(i){var t,a=g.Deferred();return(t=h.ajax.post("customize-nav-menus-insert-auto-draft",{"customize-menus-nonce":v.settings.nonce["customize-menus"],wp_customize:"on",customize_changeset_uuid:v.settings.changeset.uuid,params:i})).done(function(n){n.post_id&&(v("nav_menus_created_posts").set(v("nav_menus_created_posts").get().concat([n.post_id])),"page"===i.post_type&&(v.section.has("static_front_page")&&v.section("static_front_page").activate(),v.control.each(function(e){var t;"dropdown-pages"===e.params.type&&(t=e.container.find('select[name^="_customize-dropdown-pages-"]')).append(new Option(i.post_title,n.post_id))})),a.resolve(n))}),t.fail(function(e){var t=e||"";void 0!==e.message&&(t=e.message),console.error(t),a.rejectWith(t)}),a.promise()},v.Menus.AvailableMenuItemsPanelView=h.Backbone.View.extend({el:"#available-menu-items",events:{"input #menu-items-search":"debounceSearch","keyup #menu-items-search":"debounceSearch","focus .menu-item-tpl":"focus","click .menu-item-tpl":"_submit","click #custom-menu-item-submit":"_submitLink","keypress #custom-menu-item-name":"_submitLink","click .new-content-item .add-content":"_submitNew","keypress .create-item-input":"_submitNew",keydown:"keyboardAccessible"},selected:null,currentMenuControl:null,debounceSearch:null,$search:null,$clearResults:null,searchTerm:"",rendered:!1,pages:{},sectionContent:"",loading:!1,addingNew:!1,initialize:function(){var a=this;v.panel.has("nav_menus")&&(this.$search=g("#menu-items-search"),this.$clearResults=this.$el.find(".clear-results"),this.sectionContent=this.$el.find(".available-menu-items-list"),this.debounceSearch=_.debounce(a.search,500),_.bindAll(this,"close"),g("#customize-controls, .customize-section-back").on("click keydown",function(e){var t=g(e.target).is(".item-delete, .item-delete *"),n=g(e.target).is(".add-new-menu-item, .add-new-menu-item *");!g("body").hasClass("adding-menu-items")||t||n||a.close()}),this.$clearResults.on("click",function(){a.$search.val("").focus().trigger("keyup")}),this.$el.on("input","#custom-menu-item-name.invalid, #custom-menu-item-url.invalid",function(){g(this).removeClass("invalid")}),v.panel("nav_menus").container.bind("expanded",function(){a.rendered||(a.initList(),a.rendered=!0)}),this.sectionContent.scroll(function(){var e=a.$el.find(".accordion-section.open .available-menu-items-list").prop("scrollHeight"),t=a.$el.find(".accordion-section.open").height();if(!a.loading&&g(this).scrollTop()>.75*e-t){var n=g(this).data("type"),i=g(this).data("object");"search"===n?a.searchTerm&&a.doSearch(a.pages.search):a.loadItems([{type:n,object:i}])}}),v.previewer.bind("url",this.close),a.delegateEvents())},search:function(e){var t=g("#available-menu-items-search"),n=g("#available-menu-items .accordion-section").not(t);e&&this.searchTerm!==e.target.value&&(""===e.target.value||t.hasClass("open")?""===e.target.value&&(t.removeClass("open"),n.show(),this.$clearResults.removeClass("is-visible")):(n.fadeOut(100),t.find(".accordion-section-content").slideDown("fast"),t.addClass("open"),this.$clearResults.addClass("is-visible")),this.searchTerm=e.target.value,this.pages.search=1,this.doSearch(1))},doSearch:function(n){var i=this,e,a=g("#available-menu-items-search"),o=a.find(".accordion-section-content"),s=h.template("available-menu-item");if(i.currentRequest&&i.currentRequest.abort(),!(n<0)){if(1<n)a.addClass("loading-more"),o.attr("aria-busy","true"),h.a11y.speak(v.Menus.data.l10n.itemsLoadingMore);else if(""===i.searchTerm)return o.html(""),void h.a11y.speak("");a.addClass("loading"),i.loading=!0,e=v.previewer.query({excludeCustomizedSaved:!0}),_.extend(e,{"customize-menus-nonce":v.settings.nonce["customize-menus"],wp_customize:"on",search:i.searchTerm,page:n}),i.currentRequest=h.ajax.post("search-available-menu-items-customizer",e),i.currentRequest.done(function(e){var t;1===n&&o.empty(),a.removeClass("loading loading-more"),o.attr("aria-busy","false"),a.addClass("open"),i.loading=!1,t=new v.Menus.AvailableItemCollection(e.items),i.collection.add(t.models),t.each(function(e){o.append(s(e.attributes))}),t.length<20?i.pages.search=-1:i.pages.search=i.pages.search+1,t&&1<n?h.a11y.speak(v.Menus.data.l10n.itemsFoundMore.replace("%d",t.length)):t&&1===n&&h.a11y.speak(v.Menus.data.l10n.itemsFound.replace("%d",t.length))}),i.currentRequest.fail(function(e){e.message&&(o.empty().append(g('<li class="nothing-found"></li>').text(e.message)),h.a11y.speak(e.message)),i.pages.search=-1}),i.currentRequest.always(function(){a.removeClass("loading loading-more"),o.attr("aria-busy","false"),i.loading=!1,i.currentRequest=null})}},initList:function(){var t=this;_.each(v.Menus.data.itemTypes,function(e){t.pages[e.type+":"+e.object]=0}),t.loadItems(v.Menus.data.itemTypes)},loadItems:function(e,t){var i=this,n,a=[],o,s,r,u={};r=h.template("available-menu-item"),n=_.isString(e)&&_.isString(t)?[{type:e,object:t}]:e,_.each(n,function(e){var t,n=e.type+":"+e.object;-1!==i.pages[n]&&((t=g("#available-menu-items-"+e.type+"-"+e.object)).find(".accordion-section-title").addClass("loading"),u[n]=t,a.push({object:e.object,type:e.type,page:i.pages[n]}))}),0!==a.length&&(i.loading=!0,o=v.previewer.query({excludeCustomizedSaved:!0}),_.extend(o,{"customize-menus-nonce":v.settings.nonce["customize-menus"],wp_customize:"on",item_types:a}),(s=h.ajax.post("load-available-menu-items-customizer",o)).done(function(e){var n;_.each(e.items,function(e,t){if(0===e.length)return 0===i.pages[t]&&u[t].find(".accordion-section-title").addClass("cannot-expand").removeClass("loading").find(".accordion-section-title > button").prop("tabIndex",-1),void(i.pages[t]=-1);"post_type:page"!==t||u[t].hasClass("open")||u[t].find(".accordion-section-title > button").click(),e=new v.Menus.AvailableItemCollection(e),i.collection.add(e.models),n=u[t].find(".available-menu-items-list"),e.each(function(e){n.append(r(e.attributes))}),i.pages[t]+=1})}),s.fail(function(e){"undefined"!=typeof console&&console.error&&console.error(e)}),s.always(function(){_.each(u,function(e){e.find(".accordion-section-title").removeClass("loading")}),i.loading=!1}))},itemSectionHeight:function(){var e,t,n,i,a;n=window.innerHeight,e=this.$el.find(".accordion-section:not( #available-menu-items-search ) .accordion-section-content"),t=this.$el.find('.accordion-section:not( #available-menu-items-search ) .available-menu-items-list:not(":only-child")'),120<(a=n-(i=46*(1+e.length)+14))&&a<290&&(e.css("max-height",a),t.css("max-height",a-60))},select:function(e){this.selected=g(e),this.selected.siblings(".menu-item-tpl").removeClass("selected"),this.selected.addClass("selected")},focus:function(e){this.select(g(e.currentTarget))},_submit:function(e){"keypress"===e.type&&13!==e.which&&32!==e.which||this.submit(g(e.currentTarget))},submit:function(e){var t,n;e||(e=this.selected),e&&this.currentMenuControl&&(this.select(e),t=g(this.selected).data("menu-item-id"),(n=this.collection.findWhere({id:t}))&&(this.currentMenuControl.addItemToMenu(n.attributes),g(e).find(".menu-item-handle").addClass("item-added")))},_submitLink:function(e){"keypress"===e.type&&13!==e.which||this.submitLink()},submitLink:function(){var e,t=g("#custom-menu-item-name"),n=g("#custom-menu-item-url"),i;this.currentMenuControl&&(i=/^((\w+:)?\/\/\w.*|\w+:(?!\/\/$)|\/|\?|#)/,""!==t.val()?i.test(n.val())?(e={title:t.val(),url:n.val(),type:"custom",type_label:v.Menus.data.l10n.custom_label,object:"custom"},this.currentMenuControl.addItemToMenu(e),n.val("http://"),t.val("")):n.addClass("invalid"):t.addClass("invalid"))},_submitNew:function(e){var t;"keypress"===e.type&&13!==e.which||this.addingNew||(t=g(e.target).closest(".accordion-section"),this.submitNew(t))},submitNew:function(a){var o=this,s=a.find(".create-item-input"),e=s.val(),t=a.find(".available-menu-items-list"),r=t.data("type"),u=t.data("object"),d=t.data("type_label"),n;if(this.currentMenuControl&&"post_type"===r){if(""===g.trim(s.val()))return s.addClass("invalid"),void s.focus();s.removeClass("invalid"),a.find(".accordion-section-title").addClass("loading"),o.addingNew=!0,s.attr("disabled","disabled"),(n=v.Menus.insertAutoDraftPost({post_title:e,post_type:u})).done(function(e){var t,n,i;t=new v.Menus.AvailableItemModel({id:"post-"+e.post_id,title:s.val(),type:r,type_label:d,object:u,object_id:e.post_id,url:e.url}),o.currentMenuControl.addItemToMenu(t.attributes),v.Menus.availableMenuItemsPanel.collection.add(t),n=a.find(".available-menu-items-list"),(i=g(h.template("available-menu-item")(t.attributes))).find(".menu-item-handle:first").addClass("item-added"),n.prepend(i),n.scrollTop(),s.val("").removeAttr("disabled"),o.addingNew=!1,a.find(".accordion-section-title").removeClass("loading")})}},open:function(e){var t=this,n;this.currentMenuControl=e,this.itemSectionHeight(),v.section.has("publish_settings")&&v.section("publish_settings").collapse(),g("body").addClass("adding-menu-items"),n=function(){t.close(),g(this).off("click",n)},g("#customize-preview").on("click",n),_(this.currentMenuControl.getMenuItemControls()).each(function(e){e.collapseForm()}),this.$el.find(".selected").removeClass("selected"),this.$search.focus()},close:function(e){(e=e||{}).returnFocus&&this.currentMenuControl&&this.currentMenuControl.container.find(".add-new-menu-item").focus(),this.currentMenuControl=null,this.selected=null,g("body").removeClass("adding-menu-items"),g("#available-menu-items .menu-item-handle.item-added").removeClass("item-added"),this.$search.val("").trigger("keyup")},keyboardAccessible:function(e){var t=13===e.which,n=27===e.which,i=9===e.which&&e.shiftKey,a=g(e.target).is(this.$search);t&&!this.$search.val()||(a&&i?(this.currentMenuControl.container.find(".add-new-menu-item").focus(),e.preventDefault()):n&&this.close({returnFocus:!0}))}}),v.Menus.MenusPanel=v.Panel.extend({attachEvents:function(){v.Panel.prototype.attachEvents.call(this);var e,t=this.container.find(".panel-meta"),n=t.find(".customize-help-toggle"),i=t.find(".customize-panel-description"),a=g("#screen-options-wrap"),o=t.find(".customize-screen-options-toggle");o.on("click keydown",function(e){if(!v.utils.isKeydownButNotEnterEvent(e))return e.preventDefault(),i.not(":hidden")&&(i.slideUp("fast"),n.attr("aria-expanded","false")),"true"===o.attr("aria-expanded")?(o.attr("aria-expanded","false"),t.removeClass("open"),t.removeClass("active-menu-screen-options"),a.slideUp("fast")):(o.attr("aria-expanded","true"),t.addClass("open"),t.addClass("active-menu-screen-options"),a.slideDown("fast")),!1}),n.on("click keydown",function(e){v.utils.isKeydownButNotEnterEvent(e)||(e.preventDefault(),"true"===o.attr("aria-expanded")&&(o.attr("aria-expanded","false"),n.attr("aria-expanded","true"),t.addClass("open"),t.removeClass("active-menu-screen-options"),a.slideUp("fast"),i.slideDown("fast")))})},ready:function(){var e=this;e.container.find(".hide-column-tog").click(function(){e.saveManageColumnsState()}),v.section("menu_locations",function(e){e.headContainer.prepend(h.template("nav-menu-locations-header")(v.Menus.data))})},saveManageColumnsState:_.debounce(function(){var e=this;e._updateHiddenColumnsRequest&&e._updateHiddenColumnsRequest.abort(),e._updateHiddenColumnsRequest=h.ajax.post("hidden-columns",{hidden:e.hidden(),screenoptionnonce:g("#screenoptionnonce").val(),page:"nav-menus"}),e._updateHiddenColumnsRequest.always(function(){e._updateHiddenColumnsRequest=null})},2e3),checked:function(){},unchecked:function(){},hidden:function(){return g(".hide-column-tog").not(":checked").map(function(){var e=this.id;return e.substring(0,e.length-5)}).get().join(",")}}),v.Menus.MenuSection=v.Section.extend({initialize:function(e,t){var n=this;v.Section.prototype.initialize.call(n,e,t),n.deferred.initSortables=g.Deferred()},ready:function(){var i=this,e,t;if(void 0===i.params.menu_id)throw new Error("params.menu_id was not defined");i.active.validate=function(){return!!v.has(i.id)&&!!v(i.id).get()},i.populateControls(),i.navMenuLocationSettings={},i.assignedLocations=new v.Value([]),v.each(function(e,t){var n=t.match(/^nav_menu_locations\[(.+?)]/);n&&(i.navMenuLocationSettings[n[1]]=e).bind(function(){i.refreshAssignedLocations()})}),i.assignedLocations.bind(function(e){i.updateAssignedLocationsInSectionTitle(e)}),i.refreshAssignedLocations(),v.bind("pane-contents-reflowed",function(){i.contentContainer.parent().length&&(i.container.find(".menu-item .menu-item-reorder-nav button").attr({tabindex:"0","aria-hidden":"false"}),i.container.find(".menu-item.move-up-disabled .menus-move-up").attr({tabindex:"-1","aria-hidden":"true"}),i.container.find(".menu-item.move-down-disabled .menus-move-down").attr({tabindex:"-1","aria-hidden":"true"}),i.container.find(".menu-item.move-left-disabled .menus-move-left").attr({tabindex:"-1","aria-hidden":"true"}),i.container.find(".menu-item.move-right-disabled .menus-move-right").attr({tabindex:"-1","aria-hidden":"true"}))}),t=function(){var e="field-"+g(this).val()+"-active";i.contentContainer.toggleClass(e,g(this).prop("checked"))},(e=v.panel("nav_menus").contentContainer.find(".metabox-prefs:first").find(".hide-column-tog")).each(t),e.on("click",t)},populateControls:function(){var n=this,e,t,i,a,o,s,r,u,d;e=n.id+"[name]",(s=v.control(e))||(s=new v.controlConstructor.nav_menu_name(e,{type:"nav_menu_name",label:v.Menus.data.l10n.menuNameLabel,section:n.id,priority:0,settings:{default:n.id}}),v.control.add(s),s.active.set(!0)),(o=v.control(n.id))||(o=new v.controlConstructor.nav_menu(n.id,{type:"nav_menu",section:n.id,priority:998,settings:{default:n.id},menu_id:n.params.menu_id}),v.control.add(o),o.active.set(!0)),t=n.id+"[locations]",(r=v.control(t))||(r=new v.controlConstructor.nav_menu_locations(t,{section:n.id,priority:999,settings:{default:n.id},menu_id:n.params.menu_id}),v.control.add(r.id,r),o.active.set(!0)),i=n.id+"[auto_add]",(u=v.control(i))||(u=new v.controlConstructor.nav_menu_auto_add(i,{type:"nav_menu_auto_add",label:"",section:n.id,priority:1e3,settings:{default:n.id}}),v.control.add(u),u.active.set(!0)),a=n.id+"[delete]",(d=v.control(a))||(d=new v.Control(a,{section:n.id,priority:1001,templateId:"nav-menu-delete-button"}),v.control.add(d.id,d),d.active.set(!0),d.deferred.embedded.done(function(){d.container.find("button").on("click",function(){var e=n.params.menu_id,t;v.Menus.getMenuControl(e).setting.set(!1)})}))},refreshAssignedLocations:function(){var e=this,n=e.params.menu_id,i=[];_.each(e.navMenuLocationSettings,function(e,t){e()===n&&i.push(t)}),e.assignedLocations.set(i)},updateAssignedLocationsInSectionTitle:function(e){var t=this,i;(i=t.container.find(".accordion-section-title:first")).find(".menu-in-location").remove(),_.each(e,function(e){var t,n;t=g('<span class="menu-in-location"></span>'),n=v.Menus.data.locationSlugMappedToName[e],t.text(v.Menus.data.l10n.menuLocation.replace("%s",n)),i.append(t)}),t.container.toggleClass("assigned-to-menu-location",0!==e.length)},onChangeExpanded:function(e,t){var n=this,i;e&&(wpNavMenu.menuList=n.contentContainer,wpNavMenu.targetList=wpNavMenu.menuList,g("#menu-to-edit").removeAttr("id"),wpNavMenu.menuList.attr("id","menu-to-edit").addClass("menu"),_.each(v.section(n.id).controls(),function(e){"nav_menu_item"===e.params.type&&e.actuallyEmbed()}),t.completeCallback&&(i=t.completeCallback),t.completeCallback=function(){"resolved"!==n.deferred.initSortables.state()&&(wpNavMenu.initSortables(),n.deferred.initSortables.resolve(wpNavMenu.menuList),v.control("nav_menu["+String(n.params.menu_id)+"]").reflowMenuItems()),_.isFunction(i)&&i()}),v.Section.prototype.onChangeExpanded.call(n,e,t)},highlightNewItemButton:function(){v.utils.highlightButton(this.contentContainer.find(".add-new-menu-item"),{delay:2e3})}}),v.Menus.createNavMenu=function e(t){var n,i,a;return i=v.Menus.generatePlaceholderAutoIncrementId(),n="nav_menu["+String(i)+"]",(a=v.create(n,n,{},{type:"nav_menu",transport:v.Menus.data.settingTransport,previewer:v.previewer})).set(g.extend({},v.Menus.data.defaultSettingValues.nav_menu,{name:t||""})),v.section.add(new v.Menus.MenuSection(n,{panel:"nav_menus",title:d(t),customizeAction:v.Menus.data.l10n.customizingMenus,priority:10,menu_id:i}))},v.Menus.NewMenuSection=v.Section.extend({attachEvents:function(){var t=this,e=t.container,n=t.contentContainer,i=/^nav_menu\[/;function a(){var t=0;return v.each(function(e){i.test(e.id)&&!1!==e.get()&&(t+=1)}),t}function o(){e.find(".add-new-menu-notice").prop("hidden",0<a())}function s(e){i.test(e.id)&&(e.bind(o),o())}function r(e){i.test(e.id)&&(e.unbind(o),o())}t.headContainer.find(".accordion-section-title").replaceWith(h.template("nav-menu-create-menu-section-title")),e.on("click",".customize-add-menu-button",function(){t.expand()}),n.on("keydown",".menu-name-field",function(e){13===e.which&&t.submit()}),n.on("click","#customize-new-menu-submit",function(e){t.submit(),e.stopPropagation(),e.preventDefault()}),v.each(s),v.bind("add",s),v.bind("removed",r),o(),v.Section.prototype.attachEvents.apply(t,arguments)},ready:function(){this.populateControls()},populateControls:function(){var e=this,t,n,i,a,o,s;t=e.id+"[name]",(a=v.control(t))||(a=new v.controlConstructor.nav_menu_name(t,{label:v.Menus.data.l10n.menuNameLabel,description:v.Menus.data.l10n.newMenuNameDescription,section:e.id,priority:0}),v.control.add(a.id,a),a.active.set(!0)),n=e.id+"[locations]",(o=v.control(n))||(o=new v.controlConstructor.nav_menu_locations(n,{section:e.id,priority:1,menu_id:"",isCreating:!0}),v.control.add(n,o),o.active.set(!0)),i=e.id+"[submit]",(s=v.control(i))||(s=new v.Control(i,{section:e.id,priority:1,templateId:"nav-menu-submit-new-button"}),v.control.add(i,s),s.active.set(!0))},submit:function(){var e,t=this.contentContainer,n=t.find(".menu-name-field").first(),i=n.val(),a;if(!i)return n.addClass("invalid"),void n.focus();a=v.Menus.createNavMenu(i),n.val(""),n.removeClass("invalid"),t.find(".assigned-menu-location input[type=checkbox]").each(function(){var e=g(this),t;e.prop("checked")&&((t=v("nav_menu_locations["+e.data("location-id")+"]")).set(a.params.menu_id),e.prop("checked",!1))}),h.a11y.speak(v.Menus.data.l10n.menuAdded),a.focus({completeCallback:function(){a.highlightNewItemButton()}})},selectDefaultLocation:function(e){var t=v.control(this.id+"[locations]"),n={};null!==e&&(n[e]=!0),t.setSelections(n)}}),v.Menus.MenuLocationControl=v.Control.extend({initialize:function(e,t){var n=this,i=e.match(/^nav_menu_locations\[(.+?)]/);n.themeLocation=i[1],v.Control.prototype.initialize.call(n,e,t)},ready:function(){var a=this,o=/^nav_menu\[(-?\d+)]/;a.setting.validate=function(e){return""===e?0:parseInt(e,10)},a.container.find(".create-menu").on("click",function(){var e=v.section("add_menu");e.selectDefaultLocation(this.dataset.locationId),e.focus()}),a.container.find(".edit-menu").on("click",function(){var e=a.setting();v.section("nav_menu["+e+"]").focus()}),a.setting.bind("change",function(){var e=0!==a.setting();a.container.find(".create-menu").toggleClass("hidden",e),a.container.find(".edit-menu").toggleClass("hidden",!e)}),v.bind("add",function(e){var t,n,i=e.id.match(o);i&&!1!==e()&&(n=i[1],t=new Option(d(e().name),n),a.container.find("select").append(t))}),v.bind("remove",function(e){var t,n=e.id.match(o);n&&(t=parseInt(n[1],10),a.setting()===t&&a.setting.set(""),a.container.find("option[value="+t+"]").remove())}),v.bind("change",function(e){var t,n=e.id.match(o);n&&(t=parseInt(n[1],10),!1===e()?(a.setting()===t&&a.setting.set(""),a.container.find("option[value="+t+"]").remove()):a.container.find("option[value="+t+"]").text(d(e().name)))})}}),v.Menus.MenuItemControl=v.Control.extend({initialize:function(e,t){var n=this;n.expanded=new v.Value(!1),n.expandedArgumentsQueue=[],n.expanded.bind(function(e){var t=n.expandedArgumentsQueue.shift();t=g.extend({},n.defaultExpandedArguments,t),n.onChangeExpanded(e,t)}),v.Control.prototype.initialize.call(n,e,t),n.active.validate=function(){var e,t=v.section(n.section());return e=!!t&&t.active()}},embed:function(){var e=this,t=e.section(),n;t&&((n=v.section(t))&&n.expanded()||v.settings.autofocus.control===e.id)&&e.actuallyEmbed()},actuallyEmbed:function(){var e=this;"resolved"!==e.deferred.embedded.state()&&(e.renderContent(),e.deferred.embedded.resolve())},ready:function(){if(void 0===this.params.menu_item_id)throw new Error("params.menu_item_id was not defined");this._setupControlToggle(),this._setupReorderUI(),this._setupUpdateUI(),this._setupRemoveUI(),this._setupLinksUI(),this._setupTitleUI()},_setupControlToggle:function(){var a=this;this.container.find(".menu-item-handle").on("click",function(e){e.preventDefault(),e.stopPropagation();var t=a.getMenuControl(),n=g(e.target).is(".item-delete, .item-delete *"),i=g(e.target).is(".add-new-menu-item, .add-new-menu-item *");!g("body").hasClass("adding-menu-items")||n||i||v.Menus.availableMenuItemsPanel.close(),t.isReordering||t.isSorting||a.toggleForm()})},_setupReorderUI:function(){var o=this,e,t;e=h.template("menu-item-reorder-nav"),o.container.find(".item-controls").after(e),(t=o.container.find(".menu-item-reorder-nav")).find(".menus-move-up, .menus-move-down, .menus-move-left, .menus-move-right").on("click",function(){var e=g(this);e.focus();var t=e.is(".menus-move-up"),n=e.is(".menus-move-down"),i=e.is(".menus-move-left"),a=e.is(".menus-move-right");t?o.moveUp():n?o.moveDown():i?o.moveLeft():a&&o.moveRight(),e.focus()})},_setupUpdateUI:function(){var s=this,e=s.setting(),t;s.elements={},s.elements.url=new v.Element(s.container.find(".edit-menu-item-url")),s.elements.title=new v.Element(s.container.find(".edit-menu-item-title")),s.elements.attr_title=new v.Element(s.container.find(".edit-menu-item-attr-title")),s.elements.target=new v.Element(s.container.find(".edit-menu-item-target")),s.elements.classes=new v.Element(s.container.find(".edit-menu-item-classes")),s.elements.xfn=new v.Element(s.container.find(".edit-menu-item-xfn")),s.elements.description=new v.Element(s.container.find(".edit-menu-item-description")),_.each(s.elements,function(n,i){n.bind(function(e){n.element.is("input[type=checkbox]")&&(e=e?n.element.val():"");var t=s.setting();t&&t[i]!==e&&((t=_.clone(t))[i]=e,s.setting.set(t))}),e&&("classes"!==i&&"xfn"!==i||!_.isArray(e[i])?n.set(e[i]):n.set(e[i].join(" ")))}),s.setting.bind(function(n,i){var t=s.params.menu_item_id,a=[],o=[],e;!1===n?(e=v.control("nav_menu["+String(i.nav_menu_term_id)+"]"),s.container.remove(),_.each(e.getMenuItemControls(),function(e){i.menu_item_parent===e.setting().menu_item_parent&&e.setting().position>i.position?a.push(e):e.setting().menu_item_parent===t&&o.push(e)}),_.each(a,function(e){var t=_.clone(e.setting());t.position+=o.length,e.setting.set(t)}),_.each(o,function(e,t){var n=_.clone(e.setting());n.position=i.position+t,n.menu_item_parent=i.menu_item_parent,e.setting.set(n)}),e.debouncedReflowMenuItems()):(_.each(n,function(e,t){s.elements[t]&&s.elements[t].set(n[t])}),s.container.find(".menu-item-data-parent-id").val(n.menu_item_parent),n.position===i.position&&n.menu_item_parent===i.menu_item_parent||s.getMenuControl().debouncedReflowMenuItems())}),t=function(){s.elements.url.element.toggleClass("invalid",s.setting.notifications.has("invalid_url"))},s.setting.notifications.bind("add",t),s.setting.notifications.bind("removed",t)},_setupRemoveUI:function(){var a=this,e;(e=a.container.find(".item-delete")).on("click",function(){var e=!0,t,n,i;g("body").hasClass("adding-menu-items")||(e=!1),n=a.container.nextAll(".customize-control-nav_menu_item:visible").first(),i=a.container.prevAll(".customize-control-nav_menu_item:visible").first(),t=n.length?n.find(!1===e?".item-edit":".item-delete").first():i.length?i.find(!1===e?".item-edit":".item-delete").first():a.container.nextAll(".customize-control-nav_menu").find(".add-new-menu-item").first(),a.container.slideUp(function(){a.setting.set(!1),h.a11y.speak(v.Menus.data.l10n.itemDeleted),t.focus()}),a.setting.set(!1)})},_setupLinksUI:function(){var e;(e=this.container.find("a.original-link")).on("click",function(e){e.preventDefault(),v.previewer.previewUrl(e.target.toString())})},_setupTitleUI:function(){var e=this,i;e.container.find(".edit-menu-item-title").on("blur",function(){g(this).val(g.trim(g(this).val()))}),i=e.container.find(".menu-item-title"),e.setting.bind(function(e){var t,n;e&&(n=(t=g.trim(e.title))||e.original_title||v.Menus.data.l10n.untitled,e._invalid&&(n=v.Menus.data.l10n.invalidTitleTpl.replace("%s",n)),t||e.original_title?i.text(n).removeClass("no-title"):i.text(n).addClass("no-title"))})},getDepth:function(){var e=this,t=e.setting(),n=0;if(!t)return 0;for(;t&&t.menu_item_parent&&(n+=1,e=v.control("nav_menu_item["+t.menu_item_parent+"]"));)t=e.setting();return n},renderContent:function(){var e=this,t=e.setting(),n;e.params.title=t.title||"",e.params.depth=e.getDepth(),e.container.data("item-depth",e.params.depth),n=["menu-item","menu-item-depth-"+String(e.params.depth),"menu-item-"+t.object,"menu-item-edit-inactive"],t._invalid?(n.push("menu-item-invalid"),e.params.title=v.Menus.data.l10n.invalidTitleTpl.replace("%s",e.params.title)):"draft"===t.status&&(n.push("pending"),e.params.title=v.Menus.data.pendingTitleTpl.replace("%s",e.params.title)),e.params.el_classes=n.join(" "),e.params.item_type_label=t.type_label,e.params.item_type=t.type,e.params.url=t.url,e.params.target=t.target,e.params.attr_title=t.attr_title,e.params.classes=_.isArray(t.classes)?t.classes.join(" "):t.classes,e.params.attr_title=t.attr_title,e.params.xfn=t.xfn,e.params.description=t.description,e.params.parent=t.menu_item_parent,e.params.original_title=t.original_title||"",e.container.addClass(e.params.el_classes),v.Control.prototype.renderContent.call(e)},getMenuControl:function(){var e,t=this.setting();return t&&t.nav_menu_term_id?v.control("nav_menu["+t.nav_menu_term_id+"]"):null},expandControlSection:function(){var e=this.container.closest(".accordion-section");e.hasClass("open")||e.find(".accordion-section-title:first").trigger("click")},_toggleExpanded:v.Section.prototype._toggleExpanded,expand:v.Section.prototype.expand,expandForm:function(e){this.expand(e)},collapse:v.Section.prototype.collapse,collapseForm:function(e){this.collapse(e)},toggleForm:function(e,t){void 0===e&&(e=!this.expanded()),e?this.expand(t):this.collapse(t)},onChangeExpanded:function(e,t){var n=this,i,a,o;a=(i=this.container).find(".menu-item-settings:first"),void 0===e&&(e=!a.is(":visible")),a.is(":visible")!==e?e?(v.control.each(function(e){n.params.type===e.params.type&&n!==e&&e.collapseForm()}),o=function(){i.removeClass("menu-item-edit-inactive").addClass("menu-item-edit-active"),n.container.trigger("expanded"),t&&t.completeCallback&&t.completeCallback()},i.find(".item-edit").attr("aria-expanded","true"),a.slideDown("fast",o),n.container.trigger("expand")):(o=function(){i.addClass("menu-item-edit-inactive").removeClass("menu-item-edit-active"),n.container.trigger("collapsed"),t&&t.completeCallback&&t.completeCallback()},n.container.trigger("collapse"),i.find(".item-edit").attr("aria-expanded","false"),a.slideUp("fast",o)):t&&t.completeCallback&&t.completeCallback()},focus:function(e){var t=this,n=(e=e||{}).completeCallback,i;i=function(){t.expandControlSection(),e.completeCallback=function(){var e;(e=t.container.find(".menu-item-settings").find("input, select, textarea, button, object, a[href], [tabindex]").filter(":visible")).first().focus(),n&&n()},t.expandForm(e)},v.section.has(t.section())?v.section(t.section()).expand({completeCallback:i}):i()},moveUp:function(){this._changePosition(-1),h.a11y.speak(v.Menus.data.l10n.movedUp)},moveDown:function(){this._changePosition(1),h.a11y.speak(v.Menus.data.l10n.movedDown)},moveLeft:function(){this._changeDepth(-1),h.a11y.speak(v.Menus.data.l10n.movedLeft)},moveRight:function(){this._changeDepth(1),h.a11y.speak(v.Menus.data.l10n.movedRight)},_changePosition:function(e){var t=this,n,i=_.clone(t.setting()),a=[],o;if(1!==e&&-1!==e)throw new Error("Offset changes by 1 are only supported.");if(t.setting()){if(_(t.getMenuControl().getMenuItemControls()).each(function(e){e.setting().menu_item_parent===i.menu_item_parent&&a.push(e.setting)}),a.sort(function(e,t){return e().position-t().position}),-1===(o=_.indexOf(a,t.setting)))throw new Error("Expected setting to be among siblings.");0===o&&e<0||o===a.length-1&&0<e||((n=a[o+e])&&n.set(g.extend(_.clone(n()),{position:i.position})),i.position+=e,t.setting.set(i))}},_changeDepth:function(e){if(1!==e&&-1!==e)throw new Error("Offset changes by 1 are only supported.");var n=this,t=_.clone(n.setting()),i=[],a,o,s;if(_(n.getMenuControl().getMenuItemControls()).each(function(e){e.setting().menu_item_parent===t.menu_item_parent&&i.push(e)}),i.sort(function(e,t){return e.setting().position-t.setting().position}),-1===(a=_.indexOf(i,n)))throw new Error("Expected control to be among siblings.");if(-1===e){if(!t.menu_item_parent)return;s=v.control("nav_menu_item["+t.menu_item_parent+"]"),_(i).chain().slice(a).each(function(e,t){e.setting.set(g.extend({},e.setting(),{menu_item_parent:n.params.menu_item_id,position:t}))}),_(n.getMenuControl().getMenuItemControls()).each(function(e){var t,n;(n=e.setting().menu_item_parent===s.setting().menu_item_parent&&e.setting().position>s.setting().position)&&(t=_.clone(e.setting()),e.setting.set(g.extend(t,{position:t.position+1})))}),t.position=s.setting().position+1,t.menu_item_parent=s.setting().menu_item_parent,n.setting.set(t)}else if(1===e){if(0===a)return;o=i[a-1],t.menu_item_parent=o.params.menu_item_id,t.position=0,_(n.getMenuControl().getMenuItemControls()).each(function(e){e.setting().menu_item_parent===t.menu_item_parent&&(t.position=Math.max(t.position,e.setting().position))}),t.position+=1,n.setting.set(t)}}}),v.Menus.MenuNameControl=v.Control.extend({ready:function(){var n=this;if(n.setting){var e=n.setting();n.nameElement=new v.Element(n.container.find(".menu-name-field")),n.nameElement.bind(function(e){var t=n.setting();t&&t.name!==e&&((t=_.clone(t)).name=e,n.setting.set(t))}),e&&n.nameElement.set(e.name),n.setting.bind(function(e){e&&n.nameElement.set(e.name)})}}}),v.Menus.MenuLocationsControl=v.Control.extend({ready:function(){var u=this;u.container.find(".assigned-menu-location").each(function(){var n=g(this),e=n.find("input[type=checkbox]"),t=new v.Element(e),i=v("nav_menu_locations["+e.data("location-id")+"]"),a=""===u.params.menu_id,o=a?_.noop:function(e){t.set(e)},s=a?_.noop:function(e){i.set(e?u.params.menu_id:0)},r=function(e){var t=v("nav_menu["+String(e)+"]");e&&t&&t()?n.find(".theme-location-set").show().find("span").text(d(t().name)):n.find(".theme-location-set").hide()};o(i.get()===u.params.menu_id),e.on("change",function(){s(this.checked)}),i.bind(function(e){o(e===u.params.menu_id),r(e)}),r(i.get())})},setSelections:function(i){
this.container.find(".menu-location").each(function(e,t){var n=t.dataset.locationId;t.checked=n in i&&i[n]})}}),v.Menus.MenuAutoAddControl=v.Control.extend({ready:function(){var n=this,e=n.setting();n.active.validate=function(){var e,t=v.section(n.section());return e=!!t&&t.active()},n.autoAddElement=new v.Element(n.container.find("input[type=checkbox].auto_add")),n.autoAddElement.bind(function(e){var t=n.setting();t&&t.name!==e&&((t=_.clone(t)).auto_add=e,n.setting.set(t))}),e&&n.autoAddElement.set(e.auto_add),n.setting.bind(function(e){e&&n.autoAddElement.set(e.auto_add)})}}),v.Menus.MenuControl=v.Control.extend({ready:function(){var t=this,n=v.section(t.section()),i=t.params.menu_id,e=t.setting(),a,o,s;if(void 0===this.params.menu_id)throw new Error("params.menu_id was not defined");t.active.validate=function(){var e;return e=!!n&&n.active()},t.$controlSection=n.headContainer,t.$sectionContent=t.container.closest(".accordion-section-content"),this._setupModel(),v.section(t.section(),function(e){e.deferred.initSortables.done(function(e){t._setupSortable(e)})}),this._setupAddition(),this._setupTitle(),e&&(a=d(e.name),v.control.each(function(e){e.extended(v.controlConstructor.widget_form)&&"nav_menu"===e.params.widget_id_base&&(e.container.find(".nav-menu-widget-form-controls:first").show(),e.container.find(".nav-menu-widget-no-menus-message:first").hide(),0===(s=e.container.find("select")).find("option[value="+String(i)+"]").length&&s.append(new Option(a,i)))}),(o=g("#available-widgets-list .widget-tpl:has( input.id_base[ value=nav_menu ] )")).find(".nav-menu-widget-form-controls:first").show(),o.find(".nav-menu-widget-no-menus-message:first").hide(),0===(s=o.find(".widget-inside select:first")).find("option[value="+String(i)+"]").length&&s.append(new Option(a,i))),_.defer(function(){t.updateInvitationVisibility()})},_setupModel:function(){var t=this,i=t.params.menu_id;t.setting.bind(function(e){var n;!1===e?t._handleDeletion():(n=d(e.name),v.control.each(function(e){var t;e.extended(v.controlConstructor.widget_form)&&"nav_menu"===e.params.widget_id_base&&e.container.find("select").find("option[value="+String(i)+"]").text(n)}))})},_setupSortable:function(e){var t=this;if(!e.is(t.$sectionContent))throw new Error("Unexpected menuList.");e.on("sortstart",function(){t.isSorting=!0}),e.on("sortstop",function(){setTimeout(function(){var e=t.$sectionContent.sortable("toArray"),a=[],n=0,i=10;t.isSorting=!1,t.$sectionContent.scrollLeft(0),_.each(e,function(e){var t,n,i;(i=e.match(/^customize-control-nav_menu_item-(-?\d+)$/,""))&&(t=parseInt(i[1],10),(n=v.control("nav_menu_item["+String(t)+"]"))&&a.push(n))}),_.each(a,function(e){if(!1!==e.setting()){var t=_.clone(e.setting());n+=1,i+=1,t.position=n,e.priority(i),t.menu_item_parent=parseInt(e.container.find(".menu-item-data-parent-id").val(),10),t.menu_item_parent||(t.menu_item_parent=0),e.setting.set(t)}})})}),t.isReordering=!1,this.container.find(".reorder-toggle").on("click",function(){t.toggleReordering(!t.isReordering)})},_setupAddition:function(){var t=this;this.container.find(".add-new-menu-item").on("click",function(e){t.$sectionContent.hasClass("reordering")||(g("body").hasClass("adding-menu-items")?(g(this).attr("aria-expanded","false"),v.Menus.availableMenuItemsPanel.close(),e.stopPropagation()):(g(this).attr("aria-expanded","true"),v.Menus.availableMenuItemsPanel.open(t)))})},_handleDeletion:function(){var e=this,t,n=e.params.menu_id,i,a,o=0;t=v.section(e.section()),i=function(){t.container.remove(),v.section.remove(t.id)},t&&t.expanded()?t.collapse({completeCallback:function(){i(),h.a11y.speak(v.Menus.data.l10n.menuDeleted),v.panel("nav_menus").focus()}}):i(),v.each(function(e){/^nav_menu\[/.test(e.id)&&!1!==e()&&(o+=1)}),v.control.each(function(e){if(e.extended(v.controlConstructor.widget_form)&&"nav_menu"===e.params.widget_id_base){var t=e.container.find("select");t.val()===String(n)&&t.prop("selectedIndex",0).trigger("change"),e.container.find(".nav-menu-widget-form-controls:first").toggle(0!==o),e.container.find(".nav-menu-widget-no-menus-message:first").toggle(0===o),e.container.find("option[value="+String(n)+"]").remove()}}),(a=g("#available-widgets-list .widget-tpl:has( input.id_base[ value=nav_menu ] )")).find(".nav-menu-widget-form-controls:first").toggle(0!==o),a.find(".nav-menu-widget-no-menus-message:first").toggle(0===o),a.find("option[value="+String(n)+"]").remove()},_setupTitle:function(){var u=this;u.setting.bind(function(e){if(e){var t=v.section(u.section()),n=u.params.menu_id,i=t.headContainer.find(".accordion-section-title"),a=t.contentContainer.find(".customize-section-title h3"),o=t.headContainer.find(".menu-in-location"),s=a.find(".customize-action"),r=d(e.name);i.text(r),o.length&&o.appendTo(i),a.text(r),s.length&&s.prependTo(a),v.control.each(function(e){/^nav_menu_locations\[/.test(e.id)&&e.container.find("option[value="+n+"]").text(r)}),t.contentContainer.find(".customize-control-checkbox input").each(function(){g(this).prop("checked")&&g(".current-menu-location-name-"+g(this).data("location-id")).text(r)})}})},toggleReordering:function(e){var t=this.container.find(".add-new-menu-item"),n=this.container.find(".reorder-toggle"),i=this.$sectionContent.find(".item-title");(e=Boolean(e))!==this.$sectionContent.hasClass("reordering")&&(this.isReordering=e,this.$sectionContent.toggleClass("reordering",e),this.$sectionContent.sortable(this.isReordering?"disable":"enable"),this.isReordering?(t.attr({tabindex:"-1","aria-hidden":"true"}),n.attr("aria-label",v.Menus.data.l10n.reorderLabelOff),h.a11y.speak(v.Menus.data.l10n.reorderModeOn),i.attr("aria-hidden","false")):(t.removeAttr("tabindex aria-hidden"),n.attr("aria-label",v.Menus.data.l10n.reorderLabelOn),h.a11y.speak(v.Menus.data.l10n.reorderModeOff),i.attr("aria-hidden","true")),e&&_(this.getMenuItemControls()).each(function(e){e.collapseForm()}))},getMenuItemControls:function(){var e,t=[],n=this.params.menu_id;return v.control.each(function(e){"nav_menu_item"===e.params.type&&e.setting()&&n===e.setting().nav_menu_term_id&&t.push(e)}),t},reflowMenuItems:function(){var e=this,t=e.getMenuItemControls(),a;(a=function(n){var t=[],i=n.currentParent;_.each(n.menuItemControls,function(e){i===e.setting().menu_item_parent&&t.push(e)}),t.sort(function(e,t){return e.setting().position-t.setting().position}),_.each(t,function(t){n.currentAbsolutePosition+=1,t.priority.set(n.currentAbsolutePosition),t.container.hasClass("menu-item-depth-"+String(n.currentDepth))||(_.each(t.container.prop("className").match(/menu-item-depth-\d+/g),function(e){t.container.removeClass(e)}),t.container.addClass("menu-item-depth-"+String(n.currentDepth))),t.container.data("item-depth",n.currentDepth),n.currentDepth+=1,n.currentParent=t.params.menu_item_id,a(n),n.currentDepth-=1,n.currentParent=i}),t.length&&(_(t).each(function(e){e.container.removeClass("move-up-disabled move-down-disabled move-left-disabled move-right-disabled"),0===n.currentDepth?e.container.addClass("move-left-disabled"):10===n.currentDepth&&e.container.addClass("move-right-disabled")}),t[0].container.addClass("move-up-disabled").addClass("move-right-disabled").toggleClass("move-down-disabled",1===t.length),t[t.length-1].container.addClass("move-down-disabled").toggleClass("move-up-disabled",1===t.length))})({menuItemControls:t,currentParent:0,currentDepth:0,currentAbsolutePosition:0}),e.updateInvitationVisibility(t),e.container.find(".reorder-toggle").toggle(1<t.length)},debouncedReflowMenuItems:_.debounce(function(){this.reflowMenuItems.apply(this,arguments)},0),addItemToMenu:function(e){var t=this,n,i,a,o,s,r=0,u=10;return _.each(t.getMenuItemControls(),function(e){!1!==e.setting()&&(u=Math.max(u,e.priority()),0===e.setting().menu_item_parent&&(r=Math.max(r,e.setting().position)))}),r+=1,u+=1,delete(e=g.extend({},v.Menus.data.defaultSettingValues.nav_menu_item,e,{nav_menu_term_id:t.params.menu_id,original_title:e.title,position:r})).id,s=v.Menus.generatePlaceholderAutoIncrementId(),n="nav_menu_item["+String(s)+"]",i={type:"nav_menu_item",transport:v.Menus.data.settingTransport,previewer:v.previewer},(a=v.create(n,n,{},i)).set(e),o=new v.controlConstructor.nav_menu_item(n,{type:"nav_menu_item",section:t.id,priority:u,settings:{default:n},menu_item_id:s}),v.control.add(o),a.preview(),t.debouncedReflowMenuItems(),h.a11y.speak(v.Menus.data.l10n.itemAdded),o},updateInvitationVisibility:function(e){var t=e||this.getMenuItemControls();this.container.find(".new-menu-item-invitation").toggle(0===t.length)}}),v.Menus.NewMenuControl=v.Control.extend({initialize:function(){"undefined"!=typeof console&&console.warn&&console.warn("[DEPRECATED] wp.customize.NewMenuControl will be removed. Please use wp.customize.Menus.createNavMenu() instead."),v.Control.prototype.initialize.apply(this,arguments)},ready:function(){this._bindHandlers()},_bindHandlers:function(){var t=this,e=g("#customize-control-new_menu_name input"),n=g("#create-new-menu-submit");e.on("keydown",function(e){13===e.which&&t.submit()}),n.on("click",function(e){t.submit(),e.stopPropagation(),e.preventDefault()})},submit:function(){var e,t,n=this.container.closest(".accordion-section-new-menu").find(".menu-name-field").first(),i=n.val(),a;if(!i)return n.addClass("invalid"),void n.focus();a=v.Menus.createNavMenu(i),n.val(""),n.removeClass("invalid"),h.a11y.speak(v.Menus.data.l10n.menuAdded),a.focus()}}),g.extend(v.controlConstructor,{nav_menu_location:v.Menus.MenuLocationControl,nav_menu_item:v.Menus.MenuItemControl,nav_menu:v.Menus.MenuControl,nav_menu_name:v.Menus.MenuNameControl,new_menu:v.Menus.NewMenuControl,nav_menu_locations:v.Menus.MenuLocationsControl,nav_menu_auto_add:v.Menus.MenuAutoAddControl}),g.extend(v.panelConstructor,{nav_menus:v.Menus.MenusPanel}),g.extend(v.sectionConstructor,{nav_menu:v.Menus.MenuSection,new_menu:v.Menus.NewMenuSection}),v.bind("ready",function(){v.Menus.availableMenuItemsPanel=new v.Menus.AvailableMenuItemsPanelView({collection:v.Menus.availableMenuItems}),v.bind("saved",function(e){(e.nav_menu_updates||e.nav_menu_item_updates)&&v.Menus.applySavedData(e)}),v.state("changesetStatus").bind(function(e){"publish"===e&&(v("nav_menus_created_posts")._value=[])}),v.previewer.bind("focus-nav-menu-item-control",v.Menus.focusMenuItemControl)}),v.Menus.applySavedData=function(e){var f={},u={};_(e.nav_menu_updates).each(function(a){var e,t,n,i,o,s,r,u,d,c,l,m,p;if("inserted"===a.status){if(!a.previous_term_id)throw new Error("Expected previous_term_id");if(!a.term_id)throw new Error("Expected term_id");if(e="nav_menu["+String(a.previous_term_id)+"]",!v.has(e))throw new Error("Expected setting to exist: "+e);if(i=v(e),!v.section.has(e))throw new Error("Expected control to exist: "+e);if(u=v.section(e),!(r=i.get()))throw new Error("Did not expect setting to be empty (deleted).");r=g.extend(_.clone(r),a.saved_value),f[a.previous_term_id]=a.term_id,t="nav_menu["+String(a.term_id)+"]",o=v.create(t,t,r,{type:"nav_menu",transport:v.Menus.data.settingTransport,previewer:v.previewer}),(p=u.expanded())&&u.collapse(),d=new v.Menus.MenuSection(t,{panel:"nav_menus",title:r.name,customizeAction:v.Menus.data.l10n.customizingMenus,type:"nav_menu",priority:u.priority.get(),menu_id:a.term_id}),v.section.add(d),v.control.each(function(e){var t,n,i;e.extended(v.controlConstructor.widget_form)&&"nav_menu"===e.params.widget_id_base&&(n=(t=e.container.find("select")).find("option[value="+String(a.previous_term_id)+"]"),(i=t.find("option[value="+String(a.term_id)+"]")).prop("selected",n.prop("selected")),n.remove())}),i.callbacks.disable(),i.set(!1),i.preview(),o.preview(),i._dirty=!1,u.container.remove(),v.section.remove(e),m=0,v.each(function(e){/^nav_menu\[/.test(e.id)&&!1!==e()&&(m+=1)}),(l=g("#available-widgets-list .widget-tpl:has( input.id_base[ value=nav_menu ] )")).find(".nav-menu-widget-form-controls:first").toggle(0!==m),l.find(".nav-menu-widget-no-menus-message:first").toggle(0===m),l.find("option[value="+String(a.previous_term_id)+"]").remove(),h.customize.control.each(function(e){/^nav_menu_locations\[/.test(e.id)&&e.container.find("option[value="+String(a.previous_term_id)+"]").remove()}),v.each(function(e){var t=v.state("saved").get();/^nav_menu_locations\[/.test(e.id)&&e.get()===a.previous_term_id&&(e.set(a.term_id),e._dirty=!1,v.state("saved").set(t),e.preview())}),p&&d.expand()}else if("updated"===a.status){if(n="nav_menu["+String(a.term_id)+"]",!v.has(n))throw new Error("Expected setting to exist: "+n);s=v(n),_.isEqual(a.saved_value,s.get())||(c=v.state("saved").get(),s.set(a.saved_value),s._dirty=!1,v.state("saved").set(c))}}),_(e.nav_menu_item_updates).each(function(e){e.previous_post_id&&(u[e.previous_post_id]=e.post_id)}),_(e.nav_menu_item_updates).each(function(e){var t,n,i,a,o,s,r;if("inserted"===e.status){if(!e.previous_post_id)throw new Error("Expected previous_post_id");if(!e.post_id)throw new Error("Expected post_id");if(t="nav_menu_item["+String(e.previous_post_id)+"]",!v.has(t))throw new Error("Expected setting to exist: "+t);if(i=v(t),!v.control.has(t))throw new Error("Expected control to exist: "+t);if(s=v.control(t),!(o=i.get()))throw new Error("Did not expect setting to be empty (deleted).");if((o=_.clone(o)).menu_item_parent<0){if(!u[o.menu_item_parent])throw new Error("inserted ID for menu_item_parent not available");o.menu_item_parent=u[o.menu_item_parent]}f[o.nav_menu_term_id]&&(o.nav_menu_term_id=f[o.nav_menu_term_id]),n="nav_menu_item["+String(e.post_id)+"]",a=v.create(n,n,o,{type:"nav_menu_item",transport:v.Menus.data.settingTransport,previewer:v.previewer}),r=new v.controlConstructor.nav_menu_item(n,{type:"nav_menu_item",menu_id:e.post_id,section:"nav_menu["+String(o.nav_menu_term_id)+"]",priority:s.priority.get(),settings:{default:n},menu_item_id:e.post_id}),s.container.remove(),v.control.remove(t),v.control.add(r),i.callbacks.disable(),i.set(!1),i.preview(),a.preview(),i._dirty=!1,r.container.toggleClass("menu-item-edit-inactive",s.container.hasClass("menu-item-edit-inactive"))}}),_.each(e.widget_nav_menu_updates,function(e,t){var n=v(t);n&&(n._value=e,n.preview())})},v.Menus.focusMenuItemControl=function(e){var t=v.Menus.getMenuItemControl(e);t&&t.focus()},v.Menus.getMenuControl=function(e){return v.control("nav_menu["+e+"]")},v.Menus.getMenuItemControl=function(e){return v.control(t(e))}}(wp.customize,wp,jQuery);